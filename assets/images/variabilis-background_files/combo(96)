YUI.add("hermes-template-trustarc-consent",function(e,a){var r=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,a,r,t,n){return'<div class="basic-banner">\n\t<div class="blackbar-banner-container"></div>\n</div>'},useData:!0}),t={};e.Array.each([],function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)}),e.Template.register("hermes/trustarc-consent",function(a,n){return n=n||{},n.partials=n.partials?e.merge(t,n.partials):t,r(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("trustarc-consent-manager-view",function(e,t){require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},loadState:function(){return this},buildContainer:function(){return this.setContainerWithTemplate("trustarc-consent"),this},activate:function(){return this.waitForTrustArc(),this.waitForBannerNode(),this},destructor:function(){clearTimeout(this.checkTrustModalTimeout)},checkManagerInteraction:function(t){var n;if(t&&t.data){try{n=JSON.parse(t.data)}catch(e){return}if(n&&"preference_manager"===n.source)"cm_loading"===n.message?this.checkIfConsentManagerIsOpen():"remove_iframe"===n.message&&n.data&&e.config.win.location.reload();else if(n&&(n.PrivacyManagerAPI||n.PrivacyManagerAPI)){var i={},a=e.config.win.PrivacyManagerAPI.callApi("getGDPRConsentDecision",e.config.win.location.host).consentDecision;a&&a.forEach(function(e){i[e]||(i[e]=1)}),a.length&&0!==a[0]&&this.appContext.cookieCatcher.handleConsentManagerChoice()}}},waitForTrustArc:function(){if("truste"in window&&"PrivacyManagerAPI"in window){clearTimeout(this.waitForTrustTimeout);var t=e.config.win.postMessage&&setInterval(function(){if(e.config.win.PrivacyManagerAPI&&t){var n={PrivacyManagerAPI:{action:"getConsentDecision",timestamp:(new Date).getTime(),self:e.config.win.location.host}};e.config.win.top.postMessage(JSON.stringify(n),"*"),t=clearInterval(t)}},50);e.config.win.addEventListener("message",this.checkManagerInteraction.bind(this)),this.registerEventHandler(e.one("body").all(".trustarc-cookie-pref-butt").on("click",function(){e.config.win.truste.eu.reopenBanner()}))}else this.waitForTrustTimeout=setTimeout(this.waitForTrustArc.bind(this),250)},waitForBannerNode:function(){var e=document.querySelector("#consent_blackbar"),t=this.get("container").one(".blackbar-banner-container");this.appContext.trustArcBannerClone&&t?(clearTimeout(this.waitForBannerTimeout),t.appendChild(this.appContext.trustArcBannerClone)):e&&t?(clearTimeout(this.waitForBannerTimeout),this.appContext.trustArcBannerClone=e,t.appendChild(e)):this.waitForBannerTimeout=setTimeout(this.waitForBannerNode.bind(this),100)},checkIfConsentManagerIsOpen:function(){if(document.querySelector(".truste_overlay"))this.checkTrustModalTimeout=setTimeout(this.checkIfConsentManagerIsOpen.bind(this),250);else{var t=this.get("container").one("#consent_blackbar").getDOMNode(),n=t.offsetHeight||t.clientHeight,i=t.offsetWidth||t.clientWidth;clearTimeout(this.checkTrustModalTimeout),(!n&&!i||0===n&&0===i)&&e.config.win.location.reload()}}})},"@VERSION@",{requires:["promise","hermes-template-trustarc-consent"],langBundles:["common"]});